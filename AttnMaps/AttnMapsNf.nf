#!/usr/bin/env nextflow
folderlist = Channel.fromList([
    'TNE0954',
    'TNE0953',
    'TNE0883',
    'TNE0058',
    'TNE0987',
    'TNE1350',
    'TNE1508',
    'TNE1418',
    'TNE0986',
    'TNE1082',
    'TNE0997',
    'TNE1102',
    'TNE0898',
    'TNE0072',
    'TNE0985',
    'TNE1001',
    'TNE1008',
    'TNE0229',
    'TNE0797',
    'TNE0340',
    'TNE1416',
    'TNE1089',
    'TNE0341',
    'TNE0969',
    'TNE0031',
    'TNE0881',
    'TNE1448',
    'TNE0228',
    'TNE1794',
    'TNE0889',
    'TNE1430',
    'TNE0993',
    'TNE0080',
    'TNE1086',
    'TNE1080',
    'TNE0880',
    'TNE0879',
    'TNE0001',
    'TNE0075',
    'TNE0956',
    'TNE1011',
    'TNE1414',
    'TNE0983',
    'TNE1426',
    'TNE0231',
    'TNE0965',
    'TNE1442',
    'TNE1409',
    'TNE0979',
    'TNE0975',
    'TNE1458',
    'TNE1407',
    'TNE1435',
    'TNE1404',
    'TNE0893',
    'TNE0884',
    'TNE0873',
    'TNE0081',
    'TNE0974',
    'TNE0077',
    'TNE1371',
    'TNE0988',
    'TNE1405',
    'TNE1078',
    'TNE0809',
    'TNE0181',
    'TNE1367',
    'TNE0959',
    'TNE0962',
    'TNE0079',
    'TNE0232',
    'TNE0003',
    'TNE0406',
    'TNE0886',
    'TNE0952',
    'TNE1075',
    'TNE0882',
    'TNE1098',
    'TNE1097',
    'TNE0008',
    'TNE1077',
    'TNE0404',
    'TNE0387',
    'TNE0541',
    'TNE1092',
    'TNE0286',
    'TNE1446',
    'TNE1452',
    'TNE1412',
    'TNE0876',
    'TNE1087',
    'TNE0980',
    'TNE0360',
    'TNE0944',
    'TNE0966',
    'TNE1499',
    'TNE0981',
    'TNE0485',
    'TNE1079',
    'TNE0230',
    'TNE0963',
    'TNE0888',
    'TNE1427',
    'TNE0891',
    'TNE1093',
    'TNE1431',
    'TNE1099',
    'TNE0798',
    'TNE1415',
    'TNE0408',
    'TNE0015',
    'TNE0892',
    'TNE0998',
    'TNE0875',
    'TNE1429',
    'TNE0308',
    'TNE1365',
    'TNE1094',
    'TNE0524',
    'TNE0870',
    'TNE0007',
    'TNE1019',
    'TNE1100',
    'TNE1903',
    'TNE0887',
    'TNE0803',
    'TNE1411',
    'TNE1428',
    'TNE1007',
    'TNE0009'
])

process AttnMaps{
    memory '3GB'
    publishDir "/home/mathiane/LNENWork/data_RoFormerMIL_CaA1CaA2_norm/dataRoFormer/script_analysis/unbeat_steed_2024_04_11_21-24"
    conda '/home/mathiane/miniconda3/envs/HaloAE'
    input:
    //file folder from folderlist
    val folder from folderlist

    script:
    """
    python /home/mathiane/LNENWork/DDS_roformer/DDS-RoFormerMIL/AttnMaps/attn_maps.py --sample_id $folder \
                            --ResExpRoformerFormat /home/mathiane/LNENWork/data_RoFormerMIL_CaA1CaA2_norm/dataRoFormer/script_analysis/unbeat_steed_2024_04_11_21-24 \
                            --PredTable predictions_all_test_folds.csv \
                            --FolderAttnMaps attn_maps_formated \
                            --viz_attn_maps viz_attn_maps \
                            --folder_tumoral_tiles /home/mathiane/LNENWork/Tiles_HE_all_samples_384_384_Vahadane_2 \
                            --folder_WSI_jpg /home/mathiane/LNENWork/FullSlidesToJpeg \
                            --tile_size 384
    """
}
